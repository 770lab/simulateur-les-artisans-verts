        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        input, textarea, select {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f7;
            color: #1d1d1f;
            line-height: 1.6;
        }

        /* === BANDEAU INFO 2026 === */
        .info-banner-2026 {
            background: linear-gradient(135deg, #14532d 0%, #166534 50%, #15803d 100%);
            color: white;
            padding: 10px 20px;
            font-size: 13px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .info-banner-2026 strong { color: #86efac; }
        .info-banner-2026 .separator-dot { opacity: 0.4; margin: 0 4px; }

        /* === AUTO-DETECTION REVENUS === */
        .revenus-section {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px solid #bbf7d0;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }
        .revenus-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
        }
        .revenus-toggle h3 {
            font-size: 14px;
            font-weight: 600;
            color: #16a34a;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0;
        }
        .revenus-toggle .toggle-arrow {
            transition: transform 0.3s ease;
            font-size: 12px;
            color: #16a34a;
        }
        .revenus-toggle .toggle-arrow.open { transform: rotate(180deg); }
        .revenus-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.3s ease;
            padding-top: 0;
        }
        .revenus-body.open {
            max-height: 500px;
            padding-top: 14px;
        }
        .revenus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        @media (max-width: 600px) {
            .revenus-grid { grid-template-columns: 1fr; }
        }
        .revenus-grid label {
            font-size: 12px;
            font-weight: 500;
            color: #475569;
            margin-bottom: 4px;
            display: block;
        }
        .revenus-grid select, .revenus-grid input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 13px;
            background: white;
            transition: border-color 0.2s;
        }
        .revenus-grid select:focus, .revenus-grid input:focus {
            border-color: #16a34a;
            outline: none;
            box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1);
        }
        .profil-result {
            margin-top: 12px;
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            text-align: center;
            display: none;
            animation: fadeSlide 0.3s ease;
        }
        @keyframes fadeSlide {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .profil-result.show { display: block; }
        .profil-result.profil-bleu {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
        .profil-result.profil-jaune {
            background: linear-gradient(135deg, #fef9c3, #fef08a);
            color: #92400e;
            border: 1px solid #fcd34d;
        }
        .profil-result.profil-violet {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            color: #5b21b6;
            border: 1px solid #c4b5fd;
        }
        .profil-result.profil-rose {
            background: linear-gradient(135deg, #fce7f3, #fbcfe8);
            color: #9d174d;
            border: 1px solid #f9a8d4;
        }

        /* === CEE DETAIL SECTION === */
        .cee-section {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border: 1px solid #93c5fd;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }
        .cee-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
        }
        .cee-toggle h3 {
            font-size: 14px;
            font-weight: 600;
            color: #2563eb;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0;
        }
        .cee-toggle .toggle-arrow {
            transition: transform 0.3s ease;
            font-size: 12px;
            color: #2563eb;
        }
        .cee-toggle .toggle-arrow.open { transform: rotate(180deg); }
        .cee-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding 0.3s ease;
            padding-top: 0;
        }
        .cee-body.open {
            max-height: 800px;
            padding-top: 14px;
        }
        .cee-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        @media (max-width: 600px) {
            .cee-grid { grid-template-columns: 1fr; }
        }
        .cee-grid label {
            font-size: 12px;
            font-weight: 500;
            color: #475569;
            margin-bottom: 4px;
            display: block;
        }
        .cee-grid select, .cee-grid input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 13px;
            background: white;
            transition: border-color 0.2s;
        }
        .cee-grid select:focus, .cee-grid input:focus {
            border-color: #2563eb;
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .cee-result {
            margin-top: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 13px;
            text-align: center;
            display: none;
            animation: fadeSlide 0.3s ease;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
        .cee-result.show { display: block; }
        .cee-hint {
            font-size: 11px;
            color: #6b7280;
            margin-top: 4px;
        }
        .cee-bloc-171, .cee-bloc-148 {
            transition: all 0.3s ease;
        }
        .cee-hidden { display: none !important; }

        /* Isolation state radio buttons */
        .g-radio {
            display: flex; align-items: flex-start; gap: 12px; padding: 14px 16px;
            border: 1.5px solid #e2e8f0; border-radius: 10px; cursor: pointer;
            transition: all 0.15s ease; font-size: 13px; background: white;
        }
        .g-radio:hover { border-color: #a3cfbb; background: #f8fdfb; }
        .g-radio.selected { border-color: #16a34a; background: #f0fdf4; }
        .g-radio input[type="radio"] { accent-color: #16a34a; margin: 3px 0 0 0; width: 18px; height: 18px; flex-shrink: 0; }
        .g-label { flex: 1; }
        .g-label-title { font-weight: 600; color: #1d1d1f; font-size: 13px; }
        .g-label-sub { font-size: 11px; color: #94a3b8; margin-top: 2px; }
        .g-value { display: none; }

        /* Dim form */
        .dim-row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 16px; }
        .dim-field label { font-weight: 600; color: #1d1d1f; font-size: 13px; display: block; margin-bottom: 6px; }
        .dim-field .req { color: #dc2626; }
        .dim-field input, .dim-field select {
            width: 100%; padding: 10px 12px; border: 1.5px solid #e2e8f0; border-radius: 8px;
            font-size: 15px; font-weight: 500; color: #0f172a; background: white; transition: border-color 0.15s;
        }
        .dim-field input:focus, .dim-field select:focus { border-color: #16a34a; outline: none; box-shadow: 0 0 0 3px rgba(22,163,74,0.08); }
        .dim-field .dim-hint { font-size: 11px; color: #94a3b8; margin-top: 4px; }

        /* Confort slider */
        .confort-box { border: 1.5px solid #e2e8f0; border-radius: 10px; padding: 16px; }
        .confort-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .confort-val { font-size: 22px; font-weight: 700; color: #16a34a; }
        .confort-lbl { font-size: 14px; font-weight: 600; color: #334155; text-transform: uppercase; letter-spacing: 0.5px; }
        input.confort-slider { -webkit-appearance: none; appearance: none; width: 100%; height: 8px; border-radius: 4px; outline: none; margin: 8px 0; padding: 0; border: none;
            background: linear-gradient(to right, #fb923c, #16a34a 50%, #3b82f6); }
        input.confort-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 26px; height: 26px; border-radius: 50%; background: white; border: 3px solid #16a34a; cursor: pointer; box-shadow: 0 1px 6px rgba(0,0,0,0.15); }
        input.confort-slider::-moz-range-thumb { width: 26px; height: 26px; border-radius: 50%; background: white; border: 3px solid #16a34a; cursor: pointer; box-shadow: 0 1px 6px rgba(0,0,0,0.15); }
        .confort-labels { display: flex; justify-content: space-between; font-size: 11px; color: #94a3b8; margin-top: 2px; }
        .confort-desc { font-size: 12px; color: #64748b; margin-top: 10px; font-style: italic; }

        /* Isolation checklist */
        .iso-check {
            display: flex; align-items: center; gap: 6px; padding: 6px 10px;
            border: 1.5px solid #e2e8f0; border-radius: 8px; cursor: pointer;
            transition: all 0.15s ease; background: white;
        }
        .iso-check:hover { border-color: #a3cfbb; background: #f8fdfb; }
        .iso-check:has(input:checked) { border-color: #16a34a; background: #f0fdf4; }
        .iso-check input[type="checkbox"] { accent-color: #16a34a; width: 15px; height: 15px; flex-shrink: 0; cursor: pointer; }
        .iso-info { flex: 1; }
        .iso-title { font-weight: 600; color: #1d1d1f; font-size: 11px; display: block; }
        .iso-sub { font-size: 10px; color: #94a3b8; display: none; }
        .iso-quand {
            padding: 4px 8px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 11px;
            color: #64748b; background: #f8fafc; display: none; cursor: pointer;
        }
        .iso-check:has(input:checked) .iso-quand { display: block; }
        .cee-kpi-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 12px;
        }
        .cee-kpi {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px 12px;
            text-align: center;
        }
        .cee-kpi .kpi-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }
        .cee-kpi .kpi-value {
            font-size: 16px;
            font-weight: 700;
            color: #1e40af;
        }
        .cee-kpi .kpi-value.green { color: #16a34a; }
        .cee-kpi .kpi-detail {
            font-size: 10px;
            color: #94a3b8;
            margin-top: 2px;
            font-family: ui-monospace, monospace;
        }

        .header {
            background: white;
            padding: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            gap: 16px;
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }
        .header-logo-img {
            height: 40px;
            width: auto;
            flex-shrink: 0;
        }
        .header-title {
            font-size: 20px;
            font-weight: 700;
            color: #1d1d1f;
            line-height: 1.2;
            white-space: nowrap;
        }
        .header-title-green {
            color: #16a34a;
            font-weight: 700;
        }
        .header-right {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            flex: 1;
            min-width: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }



        .btn-apply {
            flex: 1;
            background: #0071e3;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-apply:hover {
            background: #0077ed;
        }

        .btn-close-modal {
            background: #f5f5f7;
            color: #1d1d1f;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-close-modal:hover {
            background: #e8e8ed;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Parameters: cards side by side horizontally */
        .parameters-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            align-items: start;
        }

        /* Results: horizontal strip of groups */
        .results-strip {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }
        .results-group {
            min-width: 0;
        }
        .results-group-hero {
            display: flex;
            flex-direction: column;
        }

        /* Bottom strip: status + actions + docs horizontal */
        .results-bottom-strip {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255,255,255,0.06);
        }
        .results-bottom-col {
            min-width: 0;
        }

        /* Upload zones in a row */
        .upload-zones-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 16px rgba(0,0,0,0.08);
        }

        .card-title {
            font-size: 12px;
            font-weight: 600;
            color: #86868b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 14px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 5px;
            color: #1d1d1f;
        }

        .form-group small {
            display: block;
            font-size: 12px;
            color: #86868b;
            margin-top: 4px;
        }

        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            font-size: 15px;
            background: white;
            transition: all 0.2s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0,113,227,0.1);
        }

        .fournisseur-only {
            display: none !important;
        }

        .fournisseur-mode .fournisseur-only {
            display: block !important;
        }
        
        .fournisseur-mode .ttc-readonly {
            display: none !important;
        }

        .client-only {
            display: block !important;
        }

        .fournisseur-mode .client-only {
            display: none !important;
        }

        /* Telepro mode: hide specific admin sections */
        .telepro-mode .telepro-hide {
            display: none !important;
        }

        /* Script telepro panel */
        .script-panel { display: none; }
        .telepro-mode .script-panel { display: block !important; }
        
        /* Telepro: reorganize layout - script left, sim right */
        .telepro-mode {
            display: grid !important;
            grid-template-columns: 0.85fr 1.15fr !important;
            flex-direction: unset !important;
        }
        .telepro-mode .script-panel { 
            grid-row: 1 / 20;
        }
        .telepro-mode .parameters-section {
            grid-template-columns: 1fr;
        }
        @media (max-width: 900px) {
            .telepro-mode { display: flex !important; flex-direction: column !important; }
            .telepro-mode .script-panel { grid-row: auto; }
        }
        /* Landscape mobile: side-by-side if wide enough */
        @media (max-height: 500px) and (orientation: landscape) {
            .telepro-mode { grid-template-columns: 1fr 1fr !important; }
            .telepro-mode .script-panel { max-height: calc(100vh - 90px); overflow-y: auto; }
            .header { padding: 4px 0; }
            .header-logo-img { height: 26px; }
            .header-title { font-size: 14px; }
        }
        
        /* Telepro: hide cards they don't need */
        .telepro-mode #coutHTCard,
        .telepro-mode .cee-kpi-row,
        .telepro-mode #ceeResult,
        .telepro-mode #calcErrorDebug { display: none !important; }
        /* Telepro: show readonly TTC, not editable */
        .telepro-mode .ttc-readonly { display: block !important; }
        .telepro-mode #ttcEditableCard { display: none !important; }
        .script-panel .script-card {
            background: linear-gradient(160deg, #0f172a 0%, #1a1a3e 50%, #1e3a5f 100%);
            border-radius: 16px;
            padding: 16px;
            color: white;
            position: sticky;
            top: 70px;
            max-height: calc(100vh - 90px);
            overflow-y: auto;
        }
        .script-panel .script-card::-webkit-scrollbar { width: 4px; }
        .script-panel .script-card::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 4px; }
        .script-panel .script-title {
            font-size: 14px;
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .script-steps-grid {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .script-step {
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            margin-bottom: 6px;
            overflow: hidden;
            transition: all 0.2s;
        }
        .script-step.active { border-color: rgba(52,211,153,0.3); background: rgba(52,211,153,0.04); }
        .script-step-header {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 13px;
            color: rgba(255,255,255,0.8);
            transition: all 0.2s;
        }
        .script-step-header:hover { background: rgba(255,255,255,0.04); }
        .script-step.active .script-step-header { color: #34d399; }
        .script-step-num {
            width: 26px; height: 26px;
            border-radius: 50%;
            background: rgba(255,255,255,0.08);
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 800; flex-shrink: 0;
        }
        .script-step.active .script-step-num { background: rgba(52,211,153,0.2); color: #34d399; }
        .script-step.done .script-step-num { background: rgba(52,211,153,0.15); color: #34d399; font-size: 0; }
        .script-step.done .script-step-num::after { content: '‚úì'; font-size: 12px; }
        .script-step-body {
            display: none;
            padding: 0 16px 14px 52px;
            font-size: 13px;
            line-height: 1.7;
            color: rgba(255,255,255,0.6);
        }
        .script-step-body input,
        .script-step-body select,
        .script-step-body button { pointer-events: auto; }
        .script-step.active .script-step-body { display: block; }
        .script-say {
            background: rgba(255,255,255,0.04);
            border-left: 3px solid rgba(52,211,153,0.4);
            padding: 10px 14px;
            border-radius: 0 8px 8px 0;
            margin: 8px 0;
            font-style: italic;
            color: rgba(255,255,255,0.75);
        }
        .script-action {
            background: rgba(59,130,246,0.1);
            border: 1px solid rgba(59,130,246,0.2);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 8px 0;
            font-size: 12px;
            font-weight: 600;
            color: #93c5fd;
        }
        .script-action::before { content: 'üñ•Ô∏è '; }
        .script-tip {
            font-size: 11px;
            color: rgba(251,191,36,0.7);
            margin-top: 4px;
        }
        .script-tip::before { content: 'üí° '; }
        .script-inputs {
            display: grid;
            gap: 8px;
            margin: 10px 0 4px;
        }
        .script-inputs.grid-2 { grid-template-columns: 1fr 1fr; }
        .script-inputs.grid-3 { grid-template-columns: 1fr 1fr 1fr; }
        .script-input-group label {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: rgba(255,255,255,0.45);
            margin-bottom: 3px;
            display: block;
        }
        .script-input-group input,
        .script-input-group select {
            width: 100%;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.15);
            background: rgba(255,255,255,0.07);
            color: white;
            font-size: 14px;
            font-weight: 600;
            box-sizing: border-box;
            transition: all 0.2s;
        }
        .script-input-group input::placeholder { color: rgba(255,255,255,0.25); }
        .script-input-group input:focus,
        .script-input-group select:focus {
            outline: none;
            border-color: rgba(52,211,153,0.5);
            background: rgba(52,211,153,0.08);
        }
        .script-input-group select option { background: #1a1a3e; color: white; }
        .script-input-group input,
        .script-input-group select { -webkit-user-select: text; user-select: text; }
        .script-iso-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 6px;
            margin: 8px 0;
        }
        .script-iso-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 7px 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.04);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
            color: rgba(255,255,255,0.5);
        }
        .script-iso-btn:has(input:checked) {
            border-color: rgba(52,211,153,0.4);
            background: rgba(52,211,153,0.1);
            color: #34d399;
        }
        .script-iso-btn input { width: 14px; height: 14px; accent-color: #34d399; cursor: pointer; }
        .script-iso-btn span { font-weight: 600; white-space: nowrap; }

        /* ===== UPLOAD DOCUMENTS ===== */
        .upload-panel {
            margin-top: 16px;
            padding: 16px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 14px;
        }
        .upload-panel { display: none; }
        .fournisseur-mode .upload-panel,
        .telepro-mode .upload-panel { display: block; }
        .upload-zone {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            margin-bottom: 8px;
            border-radius: 10px;
            border: 2px dashed rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.02);
            cursor: pointer;
            transition: all 0.25s;
            position: relative;
        }
        .upload-zone:last-of-type { margin-bottom: 0; }
        .upload-zone:hover {
            border-color: rgba(52,211,153,0.3);
            background: rgba(52,211,153,0.04);
        }
        .upload-zone.dragover {
            border-color: rgba(52,211,153,0.5);
            background: rgba(52,211,153,0.08);
            transform: scale(1.01);
        }
        .upload-zone.uploaded {
            border-style: solid;
            border-color: rgba(52,211,153,0.3);
            background: rgba(52,211,153,0.06);
        }
        .upload-icon { font-size: 24px; flex-shrink: 0; }
        .upload-label {
            font-size: 13px;
            font-weight: 700;
            color: rgba(255,255,255,0.7);
            line-height: 1.2;
        }
        .upload-hint {
            font-size: 11px;
            color: rgba(255,255,255,0.3);
            margin-left: auto;
            white-space: nowrap;
        }
        .upload-zone.uploaded .upload-hint { display: none; }
        .upload-status {
            font-size: 11px;
            color: #34d399;
            margin-left: auto;
            font-weight: 600;
            display: none;
        }
        .upload-zone.uploaded .upload-status { display: block; }

        .results-sidebar {
            position: static;
        }

        .summary-card {
            background: linear-gradient(165deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,255,255,0.05);
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
        }


        .summary-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: var(--scroll-gradient, linear-gradient(90deg, #34d399, #22d3ee, #818cf8));
            transition: background 0.4s ease;
        }

        .result-row-card {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 12px;
            padding: 14px 18px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.25s ease;
            position: relative;
            overflow: hidden;
        }
        .result-row-card:hover {
            background: rgba(255,255,255,0.07);
            border-color: rgba(255,255,255,0.12);
            transform: translateY(-1px);
        }
        .result-row-card .rrc-label {
            font-size: 13px;
            font-weight: 500;
            color: rgba(255,255,255,0.55);
            letter-spacing: 0.3px;
        }
        .result-row-card .rrc-value {
            font-size: 20px;
            font-weight: 700;
            color: #f1f5f9;
            font-variant-numeric: tabular-nums;
        }
        .result-row-card .rrc-value.green { color: #34d399; }
        .result-row-card .rrc-value.yellow { color: #fbbf24; }
        .result-row-card .rrc-value.red { color: #f87171; }
        .result-row-card .rrc-value.cyan { color: #22d3ee; }
        .result-row-card .rrc-value.blue { color: #60a5fa; }

        .result-highlight-card {
            background: linear-gradient(135deg, rgba(52,211,153,0.12) 0%, rgba(34,211,238,0.08) 100%);
            border: 1px solid rgba(52,211,153,0.2);
            border-radius: 14px;
            padding: 14px 20px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }
        .result-highlight-card .rhc-label {
            font-size: 11px;
            font-weight: 700;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        .result-highlight-card .rhc-value {
            font-size: 22px;
            font-weight: 800;
            color: #34d399;
        }

        .glow-separator {
            height: 2px;
            margin: 16px 0;
            border-radius: 2px;
            background: var(--scroll-gradient, linear-gradient(90deg, #34d399, #22d3ee, #818cf8));
            opacity: 0.4;
            transition: opacity 0.3s, background 0.6s;
        }
        .glow-separator:hover { opacity: 0.7; }

        .dark-section-title {
            font-size: 11px;
            font-weight: 700;
            color: rgba(255,255,255,0.35);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            padding-left: 2px;
        }

        .scenario-label-dark {
            font-size: 13px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 18px;
            padding: 12px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            border-left: 3px solid #34d399;
            line-height: 1.5;
            transition: border-color 0.4s;
        }
        .scenario-label-dark strong { font-weight: 600; color: #f1f5f9; }
        .scenario-label-dark .separator { color: rgba(255,255,255,0.3); margin: 0 8px; }

        .rac-dark-section {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 12px;
            padding: 16px;
        }
        .rac-dark-section .amount-label {
            color: rgba(255,255,255,0.45);
        }
        .rac-dark-section input[type="number"] {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.12);
            color: #f1f5f9;
            font-size: 22px;
            font-weight: 700;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            transition: border-color 0.2s;
        }
        .rac-dark-section input[type="number"]:focus {
            border-color: #34d399;
            box-shadow: 0 0 0 3px rgba(52,211,153,0.15);
            outline: none;
        }
        .rac-dark-section .note-small { color: rgba(255,255,255,0.35); }

        .ttc-input-dark {
            font-size: 24px;
            font-weight: 700;
            text-align: right;
            padding: 10px 14px;
            width: 100%;
            border: 2px solid rgba(96,165,250,0.4);
            border-radius: 10px;
            background: rgba(255,255,255,0.05);
            color: #f1f5f9;
            margin-bottom: 6px;
            transition: border-color 0.2s;
        }
        .ttc-input-dark:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96,165,250,0.15);
            outline: none;
        }

        .btn-dark-export {
            width: 100%;
            border: 1px solid rgba(255,255,255,0.1);
            padding: 14px 20px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.6);
            letter-spacing: 0.3px;
        }
        .btn-dark-export:hover {
            background: rgba(255,255,255,0.12);
            color: white;
            border-color: rgba(255,255,255,0.2);
        }
        .btn-dark-export.pdf { }
        .btn-dark-export.whatsapp { }

        .summary-header {
            font-size: 12px;
            font-weight: 600;
            color: #86868b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .scenario-label {
            font-size: 13px;
            color: #1d1d1f;
            margin-bottom: 20px;
            padding: 14px;
            background: #f5f5f7;
            border-radius: 8px;
            border-left: 4px solid #0071e3;
            line-height: 1.5;
        }
        
        .scenario-label strong {
            font-weight: 600;
        }
        
        .scenario-label .separator {
            color: #86868b;
            margin: 0 8px;
        }
        
        .color-bleu { color: #0071e3; }
        .color-jaune { color: #fbbf24; }
        .color-violet { color: #8b5cf6; }
        .color-rose { color: #ec4899; }

        .amount-row {
            margin-bottom: 12px;
        }

        .amount-label {
            font-size: 12px;
            color: #86868b;
            margin-bottom: 4px;
        }

        .amount-value {
            font-size: 26px;
            font-weight: 700;
            color: #1d1d1f;
        }

        .amount-value.highlight {
            color: #34c759;
        }

        .rac-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 16px rgba(0,0,0,0.08);
        }

        .rac-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .rac-item input {
            font-size: 22px;
            font-weight: 700;
            color: #1d1d1f;
            text-align: center;
            padding: 8px 10px;
        }

        .final-amount {
            text-align: right;
            padding-top: 20px;
            border-top: 2px solid #f5f5f7;
        }

        .final-amount .amount-label {
            font-size: 13px;
            color: #86868b;
            margin-bottom: 6px;
        }

        .final-amount .amount-value {
            font-size: 34px;
            font-weight: 700;
            color: #1d1d1f;
        }

        .status-badge {
            padding: 18px 24px;
            font-weight: 700;
            font-size: 15px;
            border-radius: 14px;
            text-align: center;
            width: 100%;
            letter-spacing: 0.3px;
            transition: all 0.3s;
            cursor: default;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .status-badge.ok {
            background: linear-gradient(135deg, #065f46, #059669);
            color: white;
            box-shadow: 0 4px 20px rgba(5, 150, 105, 0.35);
        }
        .status-badge.danger {
            background: linear-gradient(135deg, #78350f, #d97706);
            color: white;
            box-shadow: 0 4px 16px rgba(217, 119, 6, 0.25);
        }


        .footer {
            text-align: center;
            padding: 8px 20px 8px;
            color: #86868b;
            font-size: 13px;
        }

        @media print {
            #loginScreen, .header, .user-bar, .guest-bar, .btn-reset, .footer, .parameters-section, .main-content, .hist-overlay, #pwdModal {
                display: none !important;
            }
            
            #printArea {
                display: block !important;
            }

            #appScreen {
                display: block !important;
            }

            body {
                background: white;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            body.print-client .print-admin-only {
                display: none !important;
            }

            .print-client-only {
                display: none !important;
            }
            body.print-client .print-client-only {
                display: block !important;
            }

            @page {
                margin: 10mm;
                size: A4;
            }
        }

        @media (max-width: 1024px) {
            .parameters-section {
                grid-template-columns: 1fr 1fr;
            }
            .results-strip {
                grid-template-columns: 1fr 1fr;
            }
            .results-bottom-strip {
                grid-template-columns: 1fr;
            }
        }

        .note-small {
            font-size: 11px;
            color: #86868b;
            text-align: center;
            margin-top: 8px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #86868b;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        /* ============ TABLET / LANDSCAPE ============ */
        @media (max-width: 900px) {
            .header-title { font-size: 17px; }
            .header-right { flex: 1; min-width: 0; }
            .user-bar { gap: 6px; }
            .view-toggle .toggle-opt { padding: 5px 10px; font-size: 12px; }
            .user-bar .btn-hist { padding: 6px 10px; font-size: 13px; }
            .user-bar .btn-logout { padding: 6px 10px; font-size: 13px; }
        }

        /* ============ MOBILE ============ */
        @media (max-width: 600px) {
            html, body { overflow-x: hidden; }
            .header { padding: 6px 0; }
            .header-row { padding: 0 8px; gap: 6px; }
            .header-left { gap: 6px; flex-shrink: 0; }
            .header-logo-img { height: 28px; }
            .header-title { display: none; }
            .header-right { flex: 1; min-width: 0; overflow: hidden; }
            
            .user-bar { gap: 4px; }
            .user-bar-top { gap: 4px; flex-wrap: nowrap; overflow: hidden; }
            .user-bar .user-name { font-size: 11px; overflow: hidden; text-overflow: ellipsis; }
            .user-bar .user-role { font-size: 8px; padding: 2px 5px; }
            .user-bar-actions { gap: 2px; flex-shrink: 0; }
            .user-bar .btn-hist { padding: 4px 6px; font-size: 11px; border-radius: 6px; min-width: 0; }
            .user-bar .btn-logout { padding: 4px 6px; font-size: 11px; border-radius: 6px; }
            .view-toggle .toggle-opt { padding: 5px 10px; font-size: 11px; }
            
            .guest-bar { justify-content: center; }
            .guest-bar .btn-login-small { padding: 5px 10px; font-size: 12px; }
            .main-content { padding: 10px 8px; gap: 12px; }
            .parameters-section { grid-template-columns: 1fr; gap: 10px; }
            .results-strip { grid-template-columns: 1fr; gap: 10px; }
            .results-bottom-strip { grid-template-columns: 1fr; gap: 10px; }
            .upload-zones-row { grid-template-columns: 1fr; }
            .container { padding: 0 8px; }
            .card { padding: 10px; margin-bottom: 0; }
            .card-title { font-size: 13px; margin-bottom: 10px; }
            .parameters-section .card { padding: 10px; }
            .results-sidebar { padding: 0; }
            .summary-card { padding: 14px; }
            .grid-3col { grid-template-columns: 1fr 1fr 1fr !important; gap: 6px !important; }
            .form-group label { font-size: 11px; }
            .form-group input, .form-group select { padding: 7px 8px; font-size: 12px; }
        }
        @media (max-width: 380px) {
            .grid-3col { grid-template-columns: 1fr 1fr !important; }
            .view-toggle .toggle-opt { padding: 3px 6px; font-size: 9px; }
        }

        /* LOGIN SCREEN */
        .login-container { display:flex; align-items:center; justify-content:center; min-height:100vh; background:linear-gradient(135deg, #0f172a 0%, #1e3a5f 40%, #134e4a 100%); }
        .login-box { background:white; padding:40px; border-radius:16px; width:360px; box-shadow:0 20px 60px rgba(0,0,0,0.3); }
        .login-box h2 { text-align:center; margin:0 0 6px; font-size:20px; }
        .login-box h2 span { color:#16a34a; }
        .login-box .login-sub { text-align:center; color:#6b7280; font-size:13px; margin-bottom:24px; }
        .login-box .form-group { margin-bottom:16px; }
        .login-box .form-group label { display:block; font-size:13px; font-weight:600; color:#374151; margin-bottom:6px; }
        .login-box .form-group input { width:100%; padding:10px 14px; border:1px solid #d1d5db; border-radius:8px; font-size:14px; box-sizing:border-box; }
        .login-box .form-group input:focus { border-color:#16a34a; outline:none; box-shadow:0 0 0 3px rgba(22,163,74,0.15); }
        .login-box .btn-login { width:100%; padding:12px; background:linear-gradient(135deg,#16a34a,#15803d); color:white; border:none; border-radius:8px; font-size:15px; font-weight:700; cursor:pointer; }
        .login-box .btn-login:hover { opacity:0.9; }
        .login-error { color:#dc2626; text-align:center; margin-top:12px; font-size:13px; display:none; }
        .login-logo { text-align:center; margin-bottom:20px; }
        .login-logo img { height:80px; width:auto; }

        /* USER BAR */
        .user-bar { display:flex; flex-direction:column; align-items:stretch; gap:6px; }
        .user-bar-top { display:flex; align-items:center; gap:10px; }
        .user-bar-actions { display:flex; align-items:center; gap:4px; margin-left:auto; }
        .user-bar .user-name { font-size:14px; color:#1f2937; font-weight:700; white-space:nowrap; }
        .user-bar .user-role { font-size:11px; color:white; background:#16a34a; padding:3px 10px; border-radius:5px; font-weight:700; white-space:nowrap; }
        .user-bar .btn-hist { padding:8px 12px; font-size:14px; background:#f3f4f6; border:1px solid #d1d5db; border-radius:8px; cursor:pointer; font-weight:600; color:#374151; transition:all 0.2s; display:flex; align-items:center; justify-content:center; }
        .user-bar .btn-hist:hover { background:#e5e7eb; }
        .user-bar .btn-logout { padding:6px 8px; font-size:14px; background:#fef2f2; border:1px solid #fecaca; border-radius:8px; cursor:pointer; color:#dc2626; transition:all 0.2s; white-space:nowrap; display:flex; align-items:center; justify-content:center; }
        .user-bar .btn-logout:hover { background:#fee2e2; }
        .guest-bar { display:flex; align-items:center; gap:8px; }
        .guest-bar .btn-login-small { padding:8px 16px; font-size:14px; background:linear-gradient(135deg,#16a34a,#15803d); color:white; border:none; border-radius:8px; cursor:pointer; font-weight:700; }

        /* VIEW TOGGLE SWITCH */
        .view-toggle { display:flex; align-items:center; gap:0; background:#f3f4f6; border-radius:8px; padding:3px; width:100%; justify-content:center; }
        .view-toggle .toggle-opt { padding:7px 14px; border-radius:6px; font-size:13px; font-weight:600; cursor:pointer; color:#6b7280; transition:all 0.2s; border:none; background:none; white-space:nowrap; flex:1; text-align:center; }
        .view-toggle .toggle-opt.active { background:white; color:#1f2937; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
        .view-toggle .toggle-opt:hover:not(.active) { color:#374151; }

        /* HISTORY MODAL */
        .hist-overlay { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center; }
        .hist-overlay.active { display:flex; }
        .hist-modal { background:white; border-radius:14px; width:90%; max-width:500px; max-height:80vh; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,0.3); }
        .hist-modal-header { padding:16px 20px; border-bottom:1px solid #e5e7eb; display:flex; justify-content:space-between; align-items:center; }
        .hist-modal-header h3 { margin:0; font-size:16px; }
        .hist-modal-close { background:none; border:none; font-size:22px; cursor:pointer; color:#6b7280; padding:0 4px; }
        .hist-modal-body { padding:16px 20px; overflow-y:auto; max-height:60vh; }
        .hist-entry { padding:10px 0; border-bottom:1px solid #f3f4f6; }
        .hist-entry:last-child { border-bottom:none; }
        .hist-meta { display:flex; gap:8px; align-items:center; margin-bottom:4px; }
        .hist-date { font-size:11px; color:#9ca3af; }
        .hist-user { font-size:11px; font-weight:700; color:#16a34a; }
        .hist-action { font-size:13px; color:#1f2937; }
        .hist-detail { font-size:11px; color:#6b7280; margin-top:2px; }
        .hist-empty { text-align:center; color:#9ca3af; padding:30px 0; }
        .hist-clear { margin-top:12px; text-align:center; }
        .hist-clear button { font-size:12px; color:#dc2626; background:none; border:1px solid #fecaca; padding:4px 12px; border-radius:6px; cursor:pointer; }

